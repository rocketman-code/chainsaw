# Perf registry: maps source files to criterion benchmarks.
# Every .rs file in the workspace MUST appear here â€” the integration test enforces this.
# Files with benchmarks = [] are explicitly exempt (not perf-sensitive).
# When a listed file changes, the corresponding benchmarks must show no regression.
#
# Benchmark names must match criterion output dirs under target/criterion/.
# For grouped benchmarks, use "group/name" format (e.g. "build_graph/ts_cold").

[[entry]]
files = ["src/lang/typescript/parser.rs"]
benchmarks = ["ts_parse_file"]

[[entry]]
files = ["src/lang/typescript/resolver.rs"]
benchmarks = ["ts_resolve"]

[[entry]]
files = ["src/lang/python/parser.rs"]
benchmarks = ["py_parse_file"]

[[entry]]
files = ["src/lang/python/resolver.rs"]
benchmarks = ["py_resolve"]

[[entry]]
files = ["src/walker.rs", "src/lang/mod.rs"]
benchmarks = ["build_graph/ts_cold", "build_graph/py_cold"]

[[entry]]
files = ["src/query.rs"]
benchmarks = ["query_trace_ts", "query_trace_py"]

[[entry]]
files = ["src/cache.rs"]
benchmarks = ["cache_load_validate_ts"]

[[entry]]
files = ["src/graph.rs"]
benchmarks = ["build_graph/ts_cold", "build_graph/py_cold", "query_trace_ts", "query_trace_py"]

# Benchmark infrastructure: changes affect measurement or verdicts for all benchmarks
[[entry]]
files = [
    "benches/benchmarks.rs",
    "benches/corpus.rs",
    "stats/src/lib.rs",
    "xtask/src/perf_judge.rs",
]
benchmarks = [
    "ts_parse_file", "py_parse_file",
    "ts_resolve", "py_resolve",
    "cache_load_validate_ts",
    "build_graph/ts_cold", "build_graph/py_cold",
    "query_trace_ts", "query_trace_py",
]

# Exempt: not perf-sensitive (CLI, formatting, re-exports, error types, test-only, orchestration)
[[entry]]
files = [
    "src/main.rs",
    "src/lib.rs",
    "src/report.rs",
    "src/error.rs",
    "src/git.rs",
    "src/loader.rs",
    "src/lang/typescript/mod.rs",
    "src/lang/python/mod.rs",
    "src/lang/python/conformance.rs",
    "benches/corpus_test.rs",
    "xtask/src/main.rs",
    "xtask/src/hooks.rs",
    "xtask/src/registry.rs",
    "xtask/src/perf_validate.rs",
    "tests/perf_registry.rs",
]
benchmarks = []
